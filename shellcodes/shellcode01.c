#include <stdlib.h>
#include <string.h>
#include <unistd.h>

/*char shellcode[]=
"\x48\x83\xec\x08\x48\x8b\x05\xc5\x2f\x00\x48\x85\xc0\x74\x02\xff\xd0\x48\x83\xc4\x08\xc3\xff\x35\xca\x2f\x00\x00\xff\x25\xcc\x2f\x00\x00\x0f\x1f\x40\x00\xff\x25\xca\x2f\x00\x00\x68\x00\x00\x00\x00\xe9\xe0\xff\xff\xff\xff\x25\x9a\x2f\x00\x00\x66\x90\x31\xed\x49\x89\xd1\x5e\x48\x89\xe2\x48\x83\xe4\xf0\x50\x54\x45\x31\xc0\x31\xc9\x48\x8d\x3d\xce\x00\x00\xff\x15\x4f\x2f\x00\x00\xf4\x66\x2e\x0f\x1f\x84\x00\x00\x00\x00\x0f\x1f\x40\x00\x48\x8d\x3d\x91\x2f\x00\x48\x8d\x05\x8a\x2f\x00\x48\x39\xf8\x74\x15\x48\x8b\x05\x2e\x2f\x00\x48\x85\xc0\x74\x09\xff\xe0\x0f\x1f\x80\x00\x00\x00\xc3\x0f\x1f\x80\x00\x00\x00\x48\x8d\x3d\x61\x2f\x00\x48\x8d\x35\x5a\x2f\x00\x48\x29\xfe\x48\x89\xf0\x48\xc1\xee\x3f\x48\xc1\xf8\x03\x48\x01\xc6\x48\xd1\xfe\x74\x14\x48\x8b\x05\xfd\x2e\x00\x48\x85\xc0\x74\x08\xff\xe0\x66\x0f\x1f\x44\x00\x00\xc3\x0f\x1f\x80\x00\x00\x00\xf3\x0f\x1e\xfa\x80\x3d\x1d\x2f\x00\x00\x75\x2b\x55\x48\x83\x3d\xda\x2e\x00\x00\x48\x89\xe5\x74\x0c\x48\x8b\x3d\xfe\x2e\x00\xe8\x29\xff\xff\xff\xe8\x64\xff\xff\xff\xc6\x05\xf5\x2e\x00\x00\x5d\xc3\x0f\x1f\x00\xc3\x0f\x1f\x80\x00\x00\x00\xf3\x0f\x1e\xfa\xe9\x77\xff\xff\xff\x55\x48\x89\xe5\xba\x00\x00\x00\x00\xbe\x00\x00\x00\x00\x48\x8d\x05\xb6\x0e\x00\x48\x89\xc7\xe8\xda\xfe\xff\xff\xb8\x00\x00\x00\x00\x5d\xc3\x48\x83\xec\x08\x48\x83\xc4\x08\xc3";

/*Récupéré (sauvegarde) avec objdump grep */

int main()
{
        execve("/bin/sh", NULL, NULL);
        return 0;
}
